(()=>{let a="https://58qr5yci46.execute-api.us-east-1.amazonaws.com/v1",s=null,d=null;function e(e,t){r.push({command:e,data:t})}var r;window.tolt_referral=null,window.tolt=window.tolt||(r=[],e.queue=r,e);let i=(t,e)=>{((t,r)=>{let a=0,n=setInterval(()=>{var e=document.querySelectorAll(t);(0<e.length||10<=a)&&(clearInterval(n),0<e.length)&&r(e),a++},500)})({payment_links:e?`a[href^="${e}"], a[href^="https://buy.stripe.com"]`:'a[href^="https://buy.stripe.com"]',pricing_table:"stripe-pricing-table",buy_button:"stripe-buy-button"}[t],e=>{("payment_links"===t?e=>{if(window.tolt_referral&&0<e.length)for(var t=0;t<e.length;t++){var r=e[t];-1===r.href.indexOf("client_reference_id")&&(-1===r.href.indexOf("?")?r.href=r.href+"?client_reference_id="+window.tolt_referral:r.href=r.href+"&client_reference_id="+window.tolt_referral)}}:e=>{if(window.tolt_referral&&0<e.length)for(var t=0;t<e.length;t++){var r=e[t];r.hasAttribute("client-reference-id")||r.setAttribute("client-reference-id",window.tolt_referral)}})(e)})};function f(t){t=("; "+document.cookie).split(`; ${t}=`);if(2===t.length){t=decodeURIComponent(t.pop().split(";").shift());try{return JSON.parse(t)}catch(e){return t}}}async function p(t,r){if(s&&d)try{let e=a+`/${t}?id=`+window.tolt_referral;return"clicks"===t&&(e=a+"/"+t),r.email&&(r.email=decodeURIComponent(r.email)),await(await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...r,public_id:s})})).json()}catch(e){console.error(`API call to ${t} failed:`,e)}else console.warn("Public ID (data-tolt) or domain is missing. API calls will not be made.")}async function o(){if(f("tolt_referral")||f("tolt_data"))window.tolt_referral=f("tolt_referral");else{var t,r,a,n,i,o,l=new URLSearchParams(window.location.search);let e={};for(t of["tolt","ref","aff","via","lmref","fpr","tap_s","afmc","f2f-ref"])if(l.has(t)){var c=window.location.href;e={public_id:s,param:t,code:l.get(t),page:c};break}0!==Object.keys(e).length&&(r=await p("clicks",e))&&r.click_id&&(i=r.cookie_duration||30,console.log("Referral code:",r.referral),a="tolt_referral",n=r.referral,i=i,(o=new Date).setTime(o.getTime()+24*i*60*60*1e3),i="expires="+o.toUTCString(),document.cookie="tolt_referral"===a?`tolt_referral=${n};${i};path=/;domain=${d};samesite=none;secure`:`${a}=${encodeURIComponent(JSON.stringify(n))};${i};path=/;domain=${d};samesite=none;secure`,window.tolt_referral=r.referral)}}async function l(e,t){switch(e){case"signup":case"conversion":case"clicks":await p(e,t);break;default:console.warn("Unknown command:",e,t)}}(async()=>{var e,t;e=document.querySelector("script[data-tolt]"),(s=e?e.getAttribute("data-tolt"):null)?(e=async()=>{var e,t;d=(r=window.location.hostname).endsWith(".local")?2<(n=r.split(".")).length?n.slice(-2).join("."):r:"undefined"!=typeof psl&&psl.parse(r).domain||r,f("tolt_referral");await o();for({command:e,data:t}of window.tolt.queue||[])await l(e,t);window.tolt.queue=[],await 0,window.tolt=async function(e,t){await l(e,t)},window.tolt.signup=async function(e){await l("signup",{email:e,public_id:s})};var r,a,n=document.querySelector("script[data-tolt]");n&&n.hasAttribute("data-stripe-type")&&(r=n.getAttribute("data-stripe-type"),a=n.getAttribute("data-stripe-domain"),i(r,a)),document.dispatchEvent(new Event("toltScriptLoaded"))},(t=document.createElement("script")).src="https://cdn.jsdelivr.net/npm/psl/dist/psl.min.js",t.onload=e,t.onerror=()=>console.error("Failed to load the PSL script"),document.head.appendChild(t)):console.warn("Public ID (data-tolt) is missing. Script initialization aborted.")})()})();